<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Order/Menu ‚Äî La Madre Coffee & Roastery</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0c10;
      --bg2:#0f121a;
      --text:#eef2f7;
      --muted:#aab3c2;
      --line:rgba(255,255,255,.10);
      --card:rgba(255,255,255,.06);
      --glass:rgba(0,0,0,.25);
      --accent:#d7b56f;
      --accent2:#7bd7c9;
      --shadow: 0 26px 90px rgba(0,0,0,.50);
      --r:22px;
      --max: 1120px;

      --chipBg: rgba(255,255,255,.04);
      --selectBg: rgba(255,255,255,.06);
      --selectText: var(--text);
    }
    [data-theme="light"]{
      --bg:#f6f7fb;
      --bg2:#ffffff;
      --text:#151a24;
      --muted:#5d6778;
      --line:rgba(0,0,0,.10);
      --card:rgba(0,0,0,.04);
      --glass:rgba(255,255,255,.65);
      --shadow: 0 18px 70px rgba(16,20,30,.12);

      --chipBg: rgba(0,0,0,.03);
      --selectBg: rgba(0,0,0,.04);
      --selectText: #151a24;
    }

    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;
      font-family:"Plus Jakarta Sans",system-ui,Segoe UI,Arial,sans-serif;
      background:linear-gradient(180deg,var(--bg),var(--bg2));
      color:var(--text);
      overflow-x:hidden; /* cegah ‚Äúgeser‚Äù horizontal */
      scrollbar-gutter: stable; /* stabil di desktop */
    }
    a{color:inherit;text-decoration:none}

    .wrap{
      width:100%;
      max-width:1120px;
      margin:0 auto;
      padding:0 18px;
    }
    @media (min-width: 1200px){
      .wrap{ max-width: 1280px; padding: 0 24px; }
    }
    @media (min-width: 1500px){
      .wrap{ max-width: 1400px; }
    }

    /* grain tipis */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.12'/%3E%3C/svg%3E");
      opacity:.06;
      z-index:-1;
    }
    [data-theme="light"] body::before{opacity:.035;}

    /* NAV */
    .nav{
      position:sticky;top:0;z-index:50;
      border-bottom:1px solid var(--line);
      backdrop-filter: blur(12px);
      background:linear-gradient(to bottom, rgba(10,12,18,.82), rgba(10,12,18,.30));
    }
    [data-theme="light"] .nav{
      background:linear-gradient(to bottom, rgba(255,255,255,.88), rgba(255,255,255,.56));
    }
    .navin{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 0}
    .brand{display:flex;gap:12px;align-items:center;min-width:0}
    .brandTxt{min-width:0}
    .logoImg{
      width:46px;height:46px;
      border-radius:18px;
      object-fit:cover;
      border:1px solid var(--line);
      box-shadow:0 18px 45px rgba(215,181,111,.18);
      flex:0 0 46px;
      background:#000;
    }
    .brand h1{
      margin:0;
      font-size:16px;
      line-height:1.12;
      letter-spacing:-.02em;
      font-weight:900;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
      text-transform:uppercase;
    }
    .brand p{
      margin:2px 0 0 0;color:var(--muted);
      font-size:12px;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis
    }

    .right{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .btn{
      padding:10px 14px;border-radius:14px;
      border:1px solid var(--line);
      background:var(--card);
      color:var(--text);
      font-weight:800;font-size:13px;
      cursor:pointer;
      transition:.18s ease;
      user-select:none;
      display:inline-flex;align-items:center;gap:8px;
    }
    .btn:hover{transform:translateY(-1px)}
    .btn.primary{
      border-color:rgba(215,181,111,.55);
      background:linear-gradient(135deg, rgba(215,181,111,.98), rgba(123,215,201,.55));
      color:#0b0c10;
      box-shadow:0 16px 40px rgba(215,181,111,.18);
    }
    .btn.danger{
      border-color:rgba(255,80,120,.45);
      background:linear-gradient(135deg, rgba(255,80,120,.18), rgba(255,255,255,.03));
    }
    .btn:active{transform:translateY(0px) scale(.98)}
    .desktopOnly{display:flex}

    .hamb{
      display:none;
      width:44px;height:44px;
      border-radius:16px;
      border:1px solid var(--line);
      background:var(--card);
      color:var(--text);
      cursor:pointer;
      font-weight:900;
      font-size:18px;
      transition:.18s ease;
    }
    .hamb:hover{transform:translateY(-1px)}
    .hamb:active{transform:translateY(0) scale(.98)}

    .mobileMenu{
      display:none;
      border-top:1px solid var(--line);
      background:linear-gradient(to bottom, rgba(10,12,18,.82), rgba(10,12,18,.50));
      backdrop-filter: blur(12px);
    }
    [data-theme="light"] .mobileMenu{
      background:linear-gradient(to bottom, rgba(255,255,255,.88), rgba(255,255,255,.70));
    }
    .mobileMenu .btn{justify-content:flex-start}
    .mobileMenu .full{
      width:100%;
      border-radius:0;
      border-left:0;border-right:0;
      border-top:0;
      padding:14px 18px;
    }
    @media (max-width: 720px){
      .brand p{display:none;}
      .brand h1{font-size:14px;}
      .desktopOnly{display:none;}
      .hamb{display:inline-flex;align-items:center;justify-content:center;}
      .mobileMenu.open{display:block;}
    }

    /* MAIN */
    .page{
      padding:22px 0 28px;
      position:relative;
    }
    .page::before{
      content:"";
      position:absolute;inset:-120px;
      background:
        radial-gradient(1000px 620px at 18% 12%, rgba(215,181,111,.14), transparent 60%),
        radial-gradient(900px 600px at 85% 10%, rgba(123,215,201,.12), transparent 60%);
      pointer-events:none;
      z-index:-1;
    }
    .headRow{
      display:flex;justify-content:space-between;align-items:flex-end;gap:12px;flex-wrap:wrap;
      margin-bottom:14px;
    }
    .headRow h2{
      margin:0;
      font-size:22px;
      letter-spacing:-.02em;
    }
    .headRow p{
      margin:6px 0 0;
      color:var(--muted);
      font-size:13.2px;
      line-height:1.6;
      max-width: 80ch;
    }

    .panel{
      border:1px solid var(--line);
      background:var(--card);
      border-radius:var(--r);
      padding:16px;
      box-shadow: var(--shadow);
    }
    [data-theme="light"] .panel{ box-shadow: var(--shadow); }

    /* FILTERS */
    .filters{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
      align-items:center;
    }
    .search{
      flex:1;
      min-width: 220px;
      display:flex;
      gap:10px;
      align-items:center;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius:16px;
      padding:10px 12px;
    }
    [data-theme="light"] .search{ background: rgba(0,0,0,.03); }
    .search input{
      width:100%;
      border:0;
      outline:none;
      background:transparent;
      color:var(--text);
      font-weight:700;
      font-size:13px;
    }
    .search input::placeholder{ color: var(--muted); font-weight:700; }

    .select{
      min-width: 200px;
      border:1px solid var(--line);
      background: var(--selectBg);
      color: var(--selectText);
      border-radius:16px;
      padding:10px 12px;
      font-weight:900;
      font-size:13px;
      outline:none;
      appearance:none;
      background-image:
        linear-gradient(45deg, transparent 50%, var(--muted) 50%),
        linear-gradient(135deg, var(--muted) 50%, transparent 50%);
      background-position:
        calc(100% - 18px) calc(50% - 3px),
        calc(100% - 12px) calc(50% - 3px);
      background-size:6px 6px;
      background-repeat:no-repeat;
    }
    .select option{
      background: var(--bg2);
      color: var(--text);
      font-weight:800;
    }
    [data-theme="light"] .select option{
      background: #ffffff;
      color: #151a24;
    }

    /* GRID LAYOUT */
    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
      margin-top:14px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }

    /* MENU LIST */
    .menuGrid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:12px;
    }
    @media (max-width: 720px){
      .menuGrid{ grid-template-columns: 1fr; }
    }

    .item{
      border:1px solid var(--line);
      border-radius:18px;
      background: rgba(255,255,255,.03);
      overflow:hidden;
      display:flex;
      gap:12px;
      padding:12px;
      align-items:stretch;
      min-width:0;
    }
    [data-theme="light"] .item{ background: rgba(0,0,0,.03); }

    .thumb{
      width:92px;
      aspect-ratio: 1 / 1;
      border-radius:16px;
      background:#111;
      border:1px solid var(--line);
      overflow:hidden;
      flex:0 0 92px;
    }
    .thumb img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .meta{
      flex:1;
      min-width:0;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      gap:10px;
    }
    .metaTop{ min-width:0; }
    .meta h3{
      margin:0;
      font-size:14px;
      font-weight:900;
      letter-spacing:-.01em;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .meta small{
      display:block;
      margin-top:6px;
      color:var(--muted);
      font-weight:800;
      font-size:12px;
      line-height:1.4;
    }
    .priceRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .price{
      font-weight:1000;
      letter-spacing:-.01em;
      color: var(--text);
      font-size:13.5px;
    }
    .tag{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: var(--chipBg);
      color: var(--muted);
      font-size:12px;
      font-weight:900;
      white-space:nowrap;
    }

    .qty{
      display:flex;
      align-items:center;
      gap:8px;
    }
    .qbtn{
      width:34px;height:34px;
      border-radius:14px;
      border:1px solid var(--line);
      background: var(--glass);
      color: var(--text);
      cursor:pointer;
      font-weight:1000;
      transition:.18s ease;
    }
    [data-theme="light"] .qbtn{ background: rgba(255,255,255,.65); }
    .qbtn:hover{ transform: translateY(-1px); }
    .qbtn:active{ transform: translateY(0) scale(.98); }

    .qval{
      min-width: 22px;
      text-align:center;
      font-weight:1000;
      color: var(--text);
    }

    /* CART */
    .cart{
      border:1px solid var(--line);
      border-radius:var(--r);
      background: rgba(255,255,255,.03);
      padding:14px;
      min-width:0;

      /* penting: jangan sticky di mobile biar tidak ‚Äúgeser‚Äù */
      position: relative;
    }
    [data-theme="light"] .cart{ background: rgba(0,0,0,.03); }

    @media (min-width: 981px){
      .cart{
        position: sticky;
        top: 86px; /* di bawah navbar */
      }
    }

    .cart h3{
      margin:0 0 10px;
      font-size:15px;
      font-weight:1000;
      letter-spacing:-.01em;
    }

    .cartList{
      display:grid;
      gap:10px;
      margin:10px 0;
    }
    .cartItem{
      display:flex;
      justify-content:space-between;
      gap:10px;
      border:1px solid var(--line);
      border-radius:16px;
      padding:10px 12px;
      background: rgba(255,255,255,.02);
    }
    [data-theme="light"] .cartItem{ background: rgba(255,255,255,.55); }
    .ciName{
      min-width:0;
    }
    .ciName b{
      display:block;
      font-size:13px;
      font-weight:1000;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .ciName small{
      display:block;
      margin-top:4px;
      color: var(--muted);
      font-weight:900;
      font-size:12px;
    }
    .ciTotal{
      font-weight:1000;
      white-space:nowrap;
      font-size:13px;
    }

    .line{
      height:1px;
      background: var(--line);
      margin:12px 0;
    }

    .field{
      display:grid;
      gap:8px;
      margin-top:10px;
    }
    .field label{
      color: var(--muted);
      font-size:12px;
      font-weight:900;
    }
    .input, .textarea{
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius:16px;
      padding:11px 12px;
      color: var(--text);
      font-weight:800;
      font-size:13px;
      outline:none;
      width:100%;
    }
    [data-theme="light"] .input, [data-theme="light"] .textarea{
      background: rgba(0,0,0,.03);
    }
    .textarea{ min-height: 84px; resize: vertical; }

    .sumRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-top:10px;
      font-weight:1000;
    }
    .sumRow span{ color: var(--muted); font-weight:900; }
    .sumRow b{ font-size:16px; }

    .cartBtns{
      display:grid;
      gap:10px;
      margin-top:12px;
    }

    .hint{
      margin-top:10px;
      color: var(--muted);
      font-size:12px;
      line-height:1.6;
      font-weight:800;
    }

    /* PAYMENT */
    .payBox{
      border:1px solid var(--line);
      border-radius:18px;
      padding:12px;
      background: rgba(0,0,0,.10);
    }
    [data-theme="light"] .payBox{ background: rgba(0,0,0,.03); }
    .payGrid{
      display:grid;
      gap:10px;
    }
    .qrisWrap{
      display:none;
      gap:10px;
      align-items:start;
      grid-template-columns: 120px 1fr;
    }
    @media (max-width:720px){
      .qrisWrap{ grid-template-columns: 1fr; }
    }
    .qrisImg{
      width:120px;
      aspect-ratio: 1 / 1;
      border-radius:16px;
      border:1px solid var(--line);
      overflow:hidden;
      background:#111;
    }
    .qrisImg img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    /* PRINT (STRUK) */
    .printArea{ display:none; }
    @media print{
      body{ background:#fff !important; color:#000 !important; }
      .nav, .page, .mobileMenu{ display:none !important; }
      .printArea{
        display:block !important;
        padding:24px;
        font-family: ui-sans-serif, system-ui, Arial;
      }
      .printCard{
        border:1px solid #ddd;
        padding:18px;
        border-radius:14px;
        max-width: 520px;
      }
      .printCard h2{ margin:0 0 6px; font-size:18px; }
      .printCard p{ margin:0 0 10px; color:#444; font-size:12px; }
      .pRow{ display:flex; justify-content:space-between; gap:10px; font-size:12px; margin:6px 0; }
      .pRow b{ font-weight:900; }
      .pLine{ height:1px; background:#eee; margin:10px 0; }
      .pSmall{ font-size:11px; color:#444; margin-top:10px; }
    }
  </style>
</head>

<body>
  <!-- NAV -->
  <div class="nav">
    <div class="wrap navin">
      <div class="brand">
        <img class="logoImg" src="logo-lamadre.png" alt="La Madre Logo">
        <div class="brandTxt">
          <h1>LA MADRE COFFEE &amp; ROASTERY</h1>
          <p>Order/Menu ‚Ä¢ Karawang</p>
        </div>
      </div>

      <!-- Desktop actions -->
      <div class="right desktopOnly">
        <button class="btn" id="themeBtn" type="button">üåì Mode</button>
        <a class="btn" href="index.html">üè† Home</a>
        <button class="btn danger" id="resetBtnTop" type="button">‚ôª Reset</button>
        <a class="btn" id="reserveBtn" target="_blank" rel="noreferrer">üìÖ Reservasi</a>
        <a class="btn primary" href="https://wa.me/6281398686801" target="_blank" rel="noreferrer">üí¨ Chat WhatsApp</a>
      </div>

      <!-- Mobile: hamburger -->
      <button class="hamb" id="hambBtn" type="button" aria-label="Buka menu" aria-expanded="false">‚ò∞</button>
    </div>

    <!-- Mobile dropdown menu -->
    <div class="mobileMenu" id="mobileMenu">
      <button class="btn full" id="themeBtnM" type="button">üåì Mode Gelap/Terang</button>
      <a class="btn full" href="index.html">üè† Home</a>
      <button class="btn danger full" id="resetBtnM" type="button">‚ôª Reset Pesanan</button>
      <a class="btn full" id="reserveBtnM" target="_blank" rel="noreferrer">üìÖ Reservasi</a>
      <a class="btn primary full" href="https://wa.me/6281398686801" target="_blank" rel="noreferrer">üí¨ Chat WhatsApp</a>
    </div>
  </div>

  <main class="page">
    <div class="wrap">
      <div class="headRow">
        <div>
          <h2>Order/Menu</h2>
          <p>
            Pilih menu ‚Üí cek keranjang ‚Üí pilih metode bayar ‚Üí klik <b>Buat Pesanan</b> untuk kirim ke WhatsApp.
            Kamu juga bisa <b>Unduh Struk (PDF)</b> (Save as PDF).
          </p>
        </div>
      </div>

      <div class="panel">
        <!-- FILTERS -->
        <div class="filters">
          <div class="search" aria-label="Cari menu">
            üîé
            <input id="searchInput" type="text" placeholder="Cari menu‚Ä¶ (contoh: latte, chicken, toast)" />
          </div>

          <select class="select" id="catSelect" aria-label="Filter kategori">
            <option value="ALL">Semua Kategori</option>
          </select>
        </div>

        <div class="grid">
          <!-- LEFT: MENU -->
          <section>
            <div class="menuGrid" id="menuGrid" aria-label="Daftar menu"></div>
            <div class="hint">
              * Foto menu bisa kamu ganti per item di data menu (bagian <b>MENU</b> di script).  
              Untuk sementara aku isi foto ‚Äúplaceholder‚Äù yang aman & rapi.
            </div>
          </section>

          <!-- RIGHT: CART -->
          <aside class="cart" aria-label="Keranjang">
            <h3>Keranjang</h3>

            <div class="cartList" id="cartList"></div>

            <div class="line"></div>

            <div class="sumRow">
              <span>Total</span>
              <b id="totalTxt">Rp 0</b>
            </div>

            <div class="field">
              <label for="custName">Nama</label>
              <input class="input" id="custName" type="text" placeholder="Contoh: Andi" autocomplete="name">
            </div>

            <div class="field">
              <label for="tableNo">No. Meja (opsional)</label>
              <input class="input" id="tableNo" type="text" placeholder="Contoh: 7">
            </div>

            <div class="field">
              <label for="note">Catatan (opsional)</label>
              <textarea class="textarea" id="note" placeholder="Contoh: less sugar, tanpa es, no pedas..."></textarea>
            </div>

            <div class="line"></div>

            <div class="payBox">
              <div style="display:flex;justify-content:space-between;gap:10px;align-items:center;flex-wrap:wrap;">
                <b style="font-size:13px;letter-spacing:-.01em;">Metode Pembayaran</b>
                <span style="color:var(--muted);font-size:12px;font-weight:900;">(QRIS semi-manual)</span>
              </div>

              <div class="payGrid" style="margin-top:10px;">
                <select class="select" id="payMethod" aria-label="Metode pembayaran">
                  <option value="CASH">Bayar di Tempat (Cash)</option>
                  <option value="QRIS">QRIS (Scan QR)</option>
                  <option value="TRANSFER">Transfer (Konfirmasi via WA)</option>
                </select>

                <div class="qrisWrap" id="qrisWrap" style="display:none;">
                  <div class="qrisImg">
                    <!-- Ganti qris.png dengan QRIS asli kamu -->
                    <img src="qris.png" alt="QRIS La Madre" onerror="this.style.display='none'; this.parentElement.style.display='none';">
                  </div>
                  <div>
                    <div style="color:var(--muted);font-size:12px;line-height:1.6;font-weight:900;">
                      Scan QRIS di samping (atau siapkan file <b>qris.png</b>). Setelah bayar, isi info berikut agar mudah dicek.
                    </div>

                    <div class="field">
                      <label for="payName">Nama Pembayar (opsional)</label>
                      <input class="input" id="payName" type="text" placeholder="Contoh: Andi / A.N. Rekening">
                    </div>

                    <div class="field">
                      <label for="payRef">No. Referensi / Catatan Pembayaran (opsional)</label>
                      <input class="input" id="payRef" type="text" placeholder="Contoh: REF123 / jam transfer / bank">
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="cartBtns">
              <button class="btn primary" id="waBtn" type="button">‚úÖ Buat Pesanan (WhatsApp)</button>
              <button class="btn" id="printBtn" type="button">üßæ Unduh Struk (PDF)</button>
              <button class="btn danger" id="resetBtn" type="button">‚ôª Reset Pesanan</button>
            </div>

            <div class="hint" id="hintBox">
              Setelah klik <b>Unduh Struk</b>, pilih printer: <b>Save as PDF</b>.
            </div>
          </aside>
        </div>
      </div>
    </div>
  </main>

  <!-- PRINT AREA -->
  <div class="printArea" id="printArea">
    <div class="printCard">
      <h2>La Madre Coffee &amp; Roastery</h2>
      <p>Order Receipt / Struk Pesanan</p>
      <div class="pRow"><span>Tanggal</span><b id="pDate">-</b></div>
      <div class="pRow"><span>Nama</span><b id="pName">-</b></div>
      <div class="pRow"><span>No. Meja</span><b id="pTable">-</b></div>
      <div class="pLine"></div>
      <div id="pItems"></div>
      <div class="pLine"></div>
      <div class="pRow"><span>Total</span><b id="pTotal">Rp 0</b></div>
      <div class="pRow"><span>Pembayaran</span><b id="pPay">-</b></div>
      <div class="pLine"></div>
      <div class="pSmall" id="pNote"></div>
      <div class="pSmall" style="margin-top:12px;">
        Terima kasih. Please come and take your time here. Enjoy!
      </div>
    </div>
  </div>

  <script>
    /* =========================
       CONFIG
    ========================= */
    const WA_NUMBER = "6281398686801";

    // Reservasi link
    (function(){
      const msg = "Halo La Madre Coffee & Roastery, saya ingin reservasi. Mohon info ketersediaan tempat ya. Terima kasih.";
      const url = `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`;
      const d = document.getElementById("reserveBtn");
      const m = document.getElementById("reserveBtnM");
      if(d) d.href = url;
      if(m) m.href = url;
    })();

    // Theme sync (sama seperti index)
    (function(){
      const key = "theme_lamadre";
      const btnD = document.getElementById("themeBtn");
      const btnM = document.getElementById("themeBtnM");
      function applySaved(){
        const saved = localStorage.getItem(key);
        if(saved === "light") document.documentElement.setAttribute("data-theme","light");
        else document.documentElement.removeAttribute("data-theme");
      }
      function toggle(){
        const isLight = document.documentElement.getAttribute("data-theme")==="light";
        if(isLight){
          document.documentElement.removeAttribute("data-theme");
          localStorage.setItem(key,"dark");
        }else{
          document.documentElement.setAttribute("data-theme","light");
          localStorage.setItem(key,"light");
        }
      }
      applySaved();
      if(btnD) btnD.addEventListener("click", toggle);
      if(btnM) btnM.addEventListener("click", toggle);
    })();

    // Mobile menu toggle
    (function(){
      const hambBtn = document.getElementById("hambBtn");
      const mobileMenu = document.getElementById("mobileMenu");
      if(!hambBtn || !mobileMenu) return;

      hambBtn.addEventListener("click", ()=>{
        const open = mobileMenu.classList.toggle("open");
        hambBtn.setAttribute("aria-expanded", open ? "true" : "false");
        hambBtn.textContent = open ? "‚úï" : "‚ò∞";
      });

      // close when click link
      mobileMenu.addEventListener("click", (e)=>{
        if(e.target.tagName === "A" || e.target.tagName === "BUTTON"){
          mobileMenu.classList.remove("open");
          hambBtn.setAttribute("aria-expanded","false");
          hambBtn.textContent = "‚ò∞";
        }
      });
    })();

    /* =========================
       MENU DATA (EDIT DI SINI)
       Kamu bisa ganti nama, harga, kategori, dan foto per item.
       price = angka rupiah (contoh 38000)
    ========================= */
    const MENU = [
      // ===== Contoh (silakan ganti sesuai PDF kamu) =====
      { id:"m1",  name:"Espresso",              price:25000, cat:"Coffee",  note:"Single shot", img:"https://images.unsplash.com/photo-1511920170033-f8396924c348?auto=format&fit=crop&w=800&q=80" },
      { id:"m2",  name:"Americano",             price:28000, cat:"Coffee",  note:"Hot / Ice",   img:"https://images.unsplash.com/photo-1521017432531-fbd92d768814?auto=format&fit=crop&w=800&q=80" },
      { id:"m3",  name:"Cafe Latte",            price:35000, cat:"Coffee",  note:"Creamy",      img:"https://images.unsplash.com/photo-1501339847302-ac426a4a7cbb?auto=format&fit=crop&w=800&q=80" },
      { id:"m4",  name:"Butterscotch Latte",    price:38000, cat:"Signature", note:"Customer fav", img:"https://images.unsplash.com/photo-1517705008128-361805f42e86?auto=format&fit=crop&w=800&q=80" },
      { id:"m5",  name:"Matcha Latte",          price:35000, cat:"Non Coffee", note:"Hot / Ice", img:"https://images.unsplash.com/photo-1528826194825-81b8a7f2c4a6?auto=format&fit=crop&w=800&q=80" },
      { id:"m6",  name:"Strawberry (Non Coffee)", price:32000, cat:"Non Coffee", note:"Fresh",  img:"https://images.unsplash.com/photo-1497534446932-c925b458314e?auto=format&fit=crop&w=800&q=80" },

      { id:"f1",  name:"Bread Toast",           price:28000, cat:"Snack",   note:"Toasty",      img:"https://images.unsplash.com/photo-1548940740-204726a19be3?auto=format&fit=crop&w=800&q=80" },
      { id:"f2",  name:"French Fries",          price:25000, cat:"Snack",   note:"Crispy",      img:"https://images.unsplash.com/photo-1573080496219-bb080dd4f877?auto=format&fit=crop&w=800&q=80" },
      { id:"f3",  name:"Chicken Katsu Rice Bowl", price:48000, cat:"Main Course", note:"Comfort food", img:"https://images.unsplash.com/photo-1604908176997-125f25cc500f?auto=format&fit=crop&w=800&q=80" },
      { id:"f4",  name:"Grilled Chicken Rice",  price:55000, cat:"Main Course", note:"Proper meals", img:"https://images.unsplash.com/photo-1604909053522-6f76e76510a5?auto=format&fit=crop&w=800&q=80" },
    ];

    /* =========================
       STATE
    ========================= */
    const cart = new Map(); // id -> qty

    const elMenuGrid  = document.getElementById("menuGrid");
    const elCartList  = document.getElementById("cartList");
    const elTotalTxt  = document.getElementById("totalTxt");
    const elSearch    = document.getElementById("searchInput");
    const elCatSelect = document.getElementById("catSelect");

    const elCustName  = document.getElementById("custName");
    const elTableNo   = document.getElementById("tableNo");
    const elNote      = document.getElementById("note");

    const elPayMethod = document.getElementById("payMethod");
    const elQrisWrap  = document.getElementById("qrisWrap");
    const elPayName   = document.getElementById("payName");
    const elPayRef    = document.getElementById("payRef");

    /* =========================
       HELPERS
    ========================= */
    const rupiah = (n) => "Rp " + (n||0).toLocaleString("id-ID");
    const byId = (id)=> MENU.find(x=>x.id===id);

    function getCategories(){
      const set = new Set(MENU.map(m=>m.cat));
      return Array.from(set).sort((a,b)=>a.localeCompare(b));
    }

    function normalize(s){
      return (s||"").toLowerCase().trim();
    }

    function calcTotal(){
      let total = 0;
      for(const [id, qty] of cart.entries()){
        const m = byId(id);
        if(m) total += m.price * qty;
      }
      return total;
    }

    /* =========================
       RENDER
    ========================= */
    function renderCategories(){
      const cats = getCategories();
      elCatSelect.innerHTML = `<option value="ALL">Semua Kategori</option>` +
        cats.map(c=>`<option value="${encodeURIComponent(c)}">${c}</option>`).join("");
    }

    function currentFilters(){
      const q = normalize(elSearch.value);
      const catVal = elCatSelect.value;
      const cat = (catVal==="ALL") ? "ALL" : decodeURIComponent(catVal);
      return { q, cat };
    }

    function filteredMenu(){
      const { q, cat } = currentFilters();
      return MENU.filter(m=>{
        const okCat = (cat==="ALL") ? true : m.cat === cat;
        const okQ = q ? (normalize(m.name).includes(q) || normalize(m.cat).includes(q) || normalize(m.note).includes(q)) : true;
        return okCat && okQ;
      });
    }

    function renderMenu(){
      const list = filteredMenu();

      if(list.length === 0){
        elMenuGrid.innerHTML = `
          <div style="grid-column:1/-1;border:1px solid var(--line);border-radius:18px;padding:14px;color:var(--muted);font-weight:900;">
            Tidak ada menu yang cocok.
          </div>
        `;
        return;
      }

      elMenuGrid.innerHTML = list.map(m=>{
        const qty = cart.get(m.id) || 0;
        return `
          <article class="item" data-id="${m.id}">
            <div class="thumb">
              <img src="${m.img}" alt="${m.name}" loading="lazy">
            </div>

            <div class="meta">
              <div class="metaTop">
                <h3 title="${m.name}">${m.name}</h3>
                <small>${m.note || m.cat}</small>
              </div>

              <div class="priceRow">
                <div>
                  <div class="price">${rupiah(m.price)}</div>
                  <div class="tag"># ${m.cat}</div>
                </div>

                <div class="qty" aria-label="Kontrol jumlah">
                  <button class="qbtn" data-act="minus" type="button">‚àí</button>
                  <div class="qval" data-qty>${qty}</div>
                  <button class="qbtn" data-act="plus" type="button">+</button>
                </div>
              </div>
            </div>
          </article>
        `;
      }).join("");
    }

    function renderCart(){
      const entries = Array.from(cart.entries()).filter(([_,q])=>q>0);

      if(entries.length === 0){
        elCartList.innerHTML = `
          <div style="border:1px dashed var(--line);border-radius:16px;padding:12px;color:var(--muted);font-weight:900;">
            Keranjang masih kosong. Tambahkan menu dulu ya üôÇ
          </div>
        `;
      }else{
        elCartList.innerHTML = entries.map(([id, qty])=>{
          const m = byId(id);
          const line = m.price * qty;
          return `
            <div class="cartItem">
              <div class="ciName">
                <b title="${m.name}">${m.name}</b>
                <small>${qty} x ${rupiah(m.price)}</small>
              </div>
              <div class="ciTotal">${rupiah(line)}</div>
            </div>
          `;
        }).join("");
      }

      elTotalTxt.textContent = rupiah(calcTotal());
    }

    function renderAll(){
      renderCategories();
      renderMenu();
      renderCart();
    }

    /* =========================
       EVENTS
    ========================= */
    elMenuGrid.addEventListener("click", (e)=>{
      const btn = e.target.closest("button.qbtn");
      if(!btn) return;
      const item = e.target.closest(".item");
      if(!item) return;

      const id = item.getAttribute("data-id");
      const act = btn.getAttribute("data-act");
      const cur = cart.get(id) || 0;

      if(act === "plus") cart.set(id, cur + 1);
      if(act === "minus") cart.set(id, Math.max(0, cur - 1));

      // update qty text inside card (biar smooth, tanpa rerender penuh)
      const qEl = item.querySelector("[data-qty]");
      if(qEl) qEl.textContent = cart.get(id) || 0;

      renderCart();
    });

    elSearch.addEventListener("input", ()=> renderMenu());
    elCatSelect.addEventListener("change", ()=> renderMenu());

    // Payment method toggle
    elPayMethod.addEventListener("change", ()=>{
      const val = elPayMethod.value;
      if(val === "QRIS"){
        elQrisWrap.style.display = "grid";
      }else{
        elQrisWrap.style.display = "none";
      }
    });

    // Reset
    function resetAll(){
      cart.clear();
      elCustName.value = "";
      elTableNo.value = "";
      elNote.value = "";
      elPayMethod.value = "CASH";
      elPayName.value = "";
      elPayRef.value = "";
      elQrisWrap.style.display = "none";
      renderMenu();
      renderCart();
    }

    document.getElementById("resetBtn").addEventListener("click", resetAll);
    document.getElementById("resetBtnTop").addEventListener("click", resetAll);
    document.getElementById("resetBtnM").addEventListener("click", resetAll);

    // WhatsApp order
    document.getElementById("waBtn").addEventListener("click", ()=>{
      const entries = Array.from(cart.entries()).filter(([_,q])=>q>0);
      if(entries.length === 0){
        alert("Keranjang masih kosong. Pilih menu dulu ya üôÇ");
        return;
      }

      const total = calcTotal();
      const name = (elCustName.value || "").trim();
      const table = (elTableNo.value || "").trim();
      const note = (elNote.value || "").trim();

      const payMethod = elPayMethod.value;
      const payName = (elPayName.value || "").trim();
      const payRef  = (elPayRef.value || "").trim();

      const lines = [];
      lines.push("Halo La Madre Coffee & Roastery, saya ingin order:");
      lines.push("");

      entries.forEach(([id, qty], idx)=>{
        const m = byId(id);
        const lineTotal = m.price * qty;
        lines.push(`${idx+1}. ${m.name} ‚Äî ${qty} x ${rupiah(m.price)} = ${rupiah(lineTotal)}`);
      });

      lines.push("");
      lines.push(`TOTAL: ${rupiah(total)}`);

      if(name) lines.push(`Nama: ${name}`);
      if(table) lines.push(`No. Meja: ${table}`);
      if(note) lines.push(`Catatan: ${note}`);

      lines.push("");
      if(payMethod === "CASH"){
        lines.push("Metode Bayar: Cash (bayar di tempat)");
      }else if(payMethod === "TRANSFER"){
        lines.push("Metode Bayar: Transfer (mohon konfirmasi)");
        if(payName) lines.push(`Nama Pembayar: ${payName}`);
        if(payRef)  lines.push(`Ref/Catatan Bayar: ${payRef}`);
      }else if(payMethod === "QRIS"){
        lines.push("Metode Bayar: QRIS (semi-manual)");
        lines.push("Status: Sudah scan / akan bayar via QRIS");
        if(payName) lines.push(`Nama Pembayar: ${payName}`);
        if(payRef)  lines.push(`Ref/Catatan Bayar: ${payRef}`);
      }

      const msg = lines.join("\n");
      const url = `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`;
      window.open(url, "_blank", "noopener,noreferrer");
    });

    // Print / Save as PDF
    document.getElementById("printBtn").addEventListener("click", ()=>{
      const entries = Array.from(cart.entries()).filter(([_,q])=>q>0);
      if(entries.length === 0){
        alert("Keranjang masih kosong. Tidak ada struk yang bisa dibuat üôÇ");
        return;
      }

      const total = calcTotal();
      const name = (elCustName.value || "-").trim() || "-";
      const table = (elTableNo.value || "-").trim() || "-";
      const note = (elNote.value || "").trim();

      const payMethod = elPayMethod.value;
      const payName = (elPayName.value || "").trim();
      const payRef  = (elPayRef.value || "").trim();

      const payTxt = (() => {
        if(payMethod==="CASH") return "Cash (bayar di tempat)";
        if(payMethod==="TRANSFER"){
          let t = "Transfer (konfirmasi)";
          if(payName) t += ` | ${payName}`;
          if(payRef)  t += ` | ${payRef}`;
          return t;
        }
        if(payMethod==="QRIS"){
          let t = "QRIS (semi-manual)";
          if(payName) t += ` | ${payName}`;
          if(payRef)  t += ` | ${payRef}`;
          return t;
        }
        return "-";
      })();

      // fill print
      const now = new Date();
      document.getElementById("pDate").textContent = now.toLocaleString("id-ID");
      document.getElementById("pName").textContent = name;
      document.getElementById("pTable").textContent = table;
      document.getElementById("pTotal").textContent = rupiah(total);
      document.getElementById("pPay").textContent = payTxt;

      const itemsHtml = entries.map(([id, qty])=>{
        const m = byId(id);
        const lt = m.price * qty;
        return `
          <div class="pRow">
            <span>${m.name} (${qty}x)</span>
            <b>${rupiah(lt)}</b>
          </div>
        `;
      }).join("");
      document.getElementById("pItems").innerHTML = itemsHtml;

      document.getElementById("pNote").textContent = note ? ("Catatan: " + note) : "Catatan: -";

      window.print(); // user pilih ‚ÄúSave as PDF‚Äù
    });

    // Initial render
    renderAll();
  </script>
</body>
</html>
