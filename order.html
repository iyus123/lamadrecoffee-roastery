<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Order/Menu ‚Ä¢ La Madre Coffee & Roastery</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0c10;
      --bg2:#0f121a;
      --text:#eef2f7;
      --muted:#aab3c2;
      --line:rgba(255,255,255,.10);
      --card:rgba(255,255,255,.06);
      --glass:rgba(0,0,0,.25);
      --accent:#d7b56f;
      --accent2:#7bd7c9;
      --shadow: 0 26px 90px rgba(0,0,0,.50);
      --r:22px;
      --max: 1120px;
    }
    [data-theme="light"]{
      --bg:#f6f7fb;
      --bg2:#ffffff;
      --text:#151a24;
      --muted:#5d6778;
      --line:rgba(0,0,0,.10);
      --card:rgba(0,0,0,.04);
      --glass:rgba(255,255,255,.65);
      --shadow: 0 18px 70px rgba(16,20,30,.12);
    }

    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;
      font-family:"Plus Jakarta Sans",system-ui,Segoe UI,Arial,sans-serif;
      background:linear-gradient(180deg,var(--bg),var(--bg2));
      color:var(--text);
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--max);margin:0 auto;padding:0 14px}

    /* ===== TOP BAR (simple) ===== */
    .orderTop{
      position:sticky;top:0;z-index:20;
      display:flex;gap:12px;align-items:center;
      padding:12px 14px;
      border-bottom:1px solid var(--line);
      background:rgba(10,12,18,.72);
      backdrop-filter: blur(12px);
    }
    [data-theme="light"] .orderTop{background:rgba(255,255,255,.86)}
    .backBtn{
      width:42px;height:42px;border-radius:16px;
      border:1px solid var(--line);
      background:var(--card);
      display:flex;align-items:center;justify-content:center;
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .orderTitle{min-width:0}
    .orderTitle b{display:block;font-size:14px;letter-spacing:-.01em}
    .orderTitle span{display:block;color:var(--muted);font-size:12px;margin-top:2px}

    .topActions{margin-left:auto;display:flex;gap:10px;align-items:center}
    .btn{
      border:1px solid var(--line);
      background:var(--card);
      color:var(--text);
      padding:10px 12px;
      border-radius:16px;
      font-weight:900;
      cursor:pointer;
      transition:.15s ease;
      display:inline-flex;align-items:center;gap:8px;
      user-select:none;
      font-size:13px;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px)}
    .btn:active{transform:translateY(0) scale(.98)}

    /* ===== MAIN LAYOUT ===== */
    .pagePad{padding:16px 0 96px;} /* supaya ga ketutup bottom bar */

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:12px;
      align-items:start;
    }
    @media(max-width: 980px){.grid{grid-template-columns:1fr}}

    .panel{
      border:1px solid var(--line);
      background:var(--card);
      border-radius:var(--r);
      padding:14px;
      box-shadow: var(--shadow);
    }
    [data-theme="light"] .panel{box-shadow: 0 18px 70px rgba(16,20,30,.10)}
    .secTitle{margin:0 0 10px 0;font-size:14px}
    .muted{color:var(--muted);font-size:12.6px;line-height:1.6;margin:0}

    .searchRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .input{
      flex:1;min-width:220px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      border-radius:16px;
      padding:12px 12px;
      font-weight:700;
      outline:none;
    }
    [data-theme="light"] .input{background:rgba(0,0,0,.03)}
    .pill{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      padding:10px 12px;
      border-radius:999px;
      cursor:pointer;
      font-weight:900;
      font-size:12px;
      user-select:none;
      transition:.15s ease;
    }
    [data-theme="light"] .pill{background:rgba(0,0,0,.03)}
    .pill.active{color:var(--text); border-color: rgba(215,181,111,.55); background:rgba(215,181,111,.12)}

    /* ===== MENU LIST ===== */
    .menuList{display:grid;gap:10px;margin-top:12px}
    .item{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:18px;
      padding:12px;
      display:flex;
      gap:12px;
      align-items:center;
    }
    [data-theme="light"] .item{background:rgba(0,0,0,.03)}
    .thumb{
      width:64px;height:64px;border-radius:16px;
      border:1px solid var(--line);
      background:
        radial-gradient(circle at 30% 30%, rgba(215,181,111,.85), rgba(123,215,201,.25), rgba(255,255,255,.06));
      flex:0 0 64px;
      overflow:hidden;
      display:flex;align-items:center;justify-content:center;
      font-weight:900;
      color:#0b0c10;
    }
    .info{min-width:0;flex:1}
    .name{margin:0;font-weight:900;font-size:13.4px;letter-spacing:-.01em}
    .meta{margin:5px 0 0 0;color:var(--muted);font-size:12.3px;line-height:1.4}
    .price{margin-top:6px;font-weight:900}
    .addBtn{
      border:1px solid rgba(215,181,111,.55);
      background:linear-gradient(135deg, rgba(215,181,111,.98), rgba(123,215,201,.55));
      color:#0b0c10;
      border-radius:16px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
      white-space:nowrap;
      user-select:none;
      transition:.15s ease;
    }
    .addBtn:hover{transform:translateY(-1px)}
    .addBtn:active{transform:translateY(0) scale(.98)}

    /* ===== CART ===== */
    .cartHead{display:flex;gap:10px;align-items:flex-start;justify-content:space-between}
    .cartHead .muted{max-width:58ch}

    .cartList{display:grid;gap:10px;margin-top:12px}
    .cartRow{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:18px;
      padding:12px;
      display:flex;gap:12px;align-items:center;
    }
    [data-theme="light"] .cartRow{background:rgba(0,0,0,.03)}
    .cartRow .info{flex:1}
    .qty{
      display:flex;gap:8px;align-items:center;
      border:1px solid var(--line);
      background:rgba(0,0,0,.10);
      border-radius:16px;
      padding:8px 10px;
      user-select:none;
    }
    [data-theme="light"] .qty{background:rgba(0,0,0,.03)}
    .qBtn{
      width:30px;height:30px;border-radius:12px;
      border:1px solid var(--line);
      background:var(--card);
      color:var(--text);
      cursor:pointer;
      font-weight:900;
      display:flex;align-items:center;justify-content:center;
    }
    .qNum{min-width:18px;text-align:center;font-weight:900}
    .rowSum{font-weight:900;white-space:nowrap}

    .summary{
      margin-top:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:18px;
      padding:12px;
      display:grid;
      gap:10px;
    }
    [data-theme="light"] .summary{background:rgba(0,0,0,.03)}
    .sumLine{display:flex;align-items:center;justify-content:space-between;gap:10px;color:var(--muted);font-size:12.6px}
    .sumLine b{color:var(--text);font-size:13px}
    .sumBig{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .sumBig b{font-size:15px}

    .formRow{display:grid;gap:10px;margin-top:12px}
    textarea.input{min-height:90px;resize:vertical}

    /* ===== BOTTOM BAR ===== */
    .bottomBar{
      position:fixed;left:0;right:0;bottom:0;z-index:30;
      padding:10px 12px;
      border-top:1px solid var(--line);
      background:rgba(10,12,18,.82);
      backdrop-filter: blur(12px);
      display:flex;gap:10px;align-items:center;
    }
    [data-theme="light"] .bottomBar{background:rgba(255,255,255,.90)}
    .bbBtn{
      border:1px solid var(--line);
      background:var(--card);
      color:var(--text);
      padding:12px 14px;
      border-radius:16px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .bbBtn.primary{
      background:linear-gradient(135deg, rgba(215,181,111,.98), rgba(123,215,201,.55));
      color:#0b0c10;
      border-color:rgba(215,181,111,.55);
    }
    .bbTotal{
      flex:1;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:16px;
      padding:10px 12px;
      min-width: 120px;
    }
    [data-theme="light"] .bbTotal{background:rgba(0,0,0,.03)}
    .bbTotal span{display:block;font-size:11px;color:var(--muted)}
    .bbTotal b{display:block;margin-top:2px;font-size:13px}

    /* ===== tiny toast ===== */
    .toast{
      position:fixed;left:12px;bottom:92px;z-index:40;
      padding:10px 12px;border-radius:16px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      color:var(--text);
      font-size:12.5px;
      opacity:0;transform:translateY(10px);
      transition:.18s ease;
      pointer-events:none;
    }
    [data-theme="light"] .toast{background:rgba(255,255,255,.85); color:var(--text)}
    .toast.show{opacity:1;transform:translateY(0)}
  </style>
</head>

<body>
  <!-- TOP BAR -->
  <header class="orderTop">
    <a class="backBtn" href="index.html" aria-label="Kembali">‚Üê</a>
    <div class="orderTitle">
      <b>Order/Menu</b>
      <span>Pilih menu ‚Üí cek total ‚Üí kirim ke WhatsApp</span>
    </div>

    <div class="topActions">
      <button class="btn" id="themeBtn" type="button">üåì Mode</button>
    </div>
  </header>

  <main class="wrap pagePad">
    <div class="grid">
      <!-- LEFT: MENU -->
      <section class="panel">
        <h2 class="secTitle">Daftar Menu</h2>
        <p class="muted">Klik <b>Tambah</b> untuk memasukkan menu ke pesanan. Kamu bisa cari dan filter kategori.</p>

        <div class="searchRow">
          <input class="input" id="searchInput" placeholder="Cari menu... (contoh: latte / chicken / matcha)" />
          <button class="pill active" data-filter="all" type="button">Semua</button>
          <button class="pill" data-filter="coffee" type="button">Coffee</button>
          <button class="pill" data-filter="noncoffee" type="button">Non Coffee</button>
          <button class="pill" data-filter="food" type="button">Food</button>
        </div>

        <div class="menuList" id="menuList"></div>
      </section>

      <!-- RIGHT: CART -->
      <aside class="panel">
        <div class="cartHead">
          <div>
            <h2 class="secTitle" style="margin:0 0 6px 0">Pesanan Kamu</h2>
            <p class="muted">Pastikan nama + catatan sudah benar. Saat kirim WA, detail item + total akan ikut.</p>
          </div>
          <button class="btn" id="resetBtnTop" type="button">üßπ Reset</button>
        </div>

        <div class="cartList" id="cartList"></div>

        <div class="summary">
          <div class="sumLine"><span>Jumlah item</span><b id="itemsText">0</b></div>
          <div class="sumBig"><span style="color:var(--muted);font-weight:900">Total</span><b id="totalTextSide">Rp 0</b></div>
        </div>

        <div class="formRow">
          <input class="input" id="nameInput" placeholder="Nama pemesan (wajib)" />
          <textarea class="input" id="noteInput" placeholder="Catatan (opsional)&#10;Contoh: tanpa gula / less ice / duduk outdoor / dll"></textarea>
        </div>

        <p class="muted" style="margin-top:12px">
          Tips: Untuk hari ramai, gunakan tombol <b>Reservasi</b> di halaman utama.
        </p>
      </aside>
    </div>
  </main>

  <!-- BOTTOM BAR -->
  <div class="bottomBar">
    <button class="bbBtn" id="resetBtn" type="button">Reset</button>

    <div class="bbTotal">
      <span>Total</span>
      <b id="totalText">Rp 0</b>
    </div>

    <button class="bbBtn primary" id="sendBtn" type="button">Kirim WA</button>
  </div>

  <div class="toast" id="toast">Tersimpan</div>

  <script>
    // =========================
    // CONFIG
    // =========================
    const WA_NUMBER = "6281398686801"; // ganti jika perlu
    const THEME_KEY = "theme_lamadre"; // sama dengan index
    const CART_KEY  = "cart_lamadre_v1";

    // =========================
    // THEME (sync with index)
    // =========================
    (function(){
      const btn = document.getElementById("themeBtn");
      const saved = localStorage.getItem(THEME_KEY);
      if(saved === "light") document.documentElement.setAttribute("data-theme","light");

      btn.addEventListener("click", ()=>{
        const isLight = document.documentElement.getAttribute("data-theme")==="light";
        if(isLight){
          document.documentElement.removeAttribute("data-theme");
          localStorage.setItem(THEME_KEY,"dark");
        }else{
          document.documentElement.setAttribute("data-theme","light");
          localStorage.setItem(THEME_KEY,"light");
        }
      });
    })();

    // =========================
    // MENU DATA (edit freely)
    // =========================
    // Catatan: kamu bisa ganti nama/harga sesuai PDF nanti.
    // Thumbnail: sementara pakai huruf (L) (C) dll supaya ringan.
    const MENU = [
      // Coffee
      { id:"espresso", name:"Espresso", price:20000, cat:"coffee", tag:"Coffee", thumb:"‚òï" },
      { id:"americano", name:"Americano", price:22000, cat:"coffee", tag:"Coffee", thumb:"‚òï" },
      { id:"cappuccino", name:"Cappuccino", price:28000, cat:"coffee", tag:"Coffee", thumb:"‚òï" },
      { id:"latte", name:"Cafe Latte", price:30000, cat:"coffee", tag:"Coffee", thumb:"‚òï" },
      { id:"caramel_latte", name:"Caramel Latte", price:33000, cat:"coffee", tag:"Coffee", thumb:"‚òï" },
      { id:"aren_latte", name:"Aren Latte", price:32000, cat:"coffee", tag:"Best Seller", thumb:"‚≠ê" },

      // Non Coffee
      { id:"matcha", name:"Matcha Latte", price:30000, cat:"noncoffee", tag:"Non Coffee", thumb:"üçµ" },
      { id:"choco", name:"Chocolate Signature", price:28000, cat:"noncoffee", tag:"Non Coffee", thumb:"üç´" },
      { id:"redvelvet", name:"Red Velvet Latte", price:30000, cat:"noncoffee", tag:"Non Coffee", thumb:"üßÅ" },
      { id:"thaitea", name:"Thai Tea", price:25000, cat:"noncoffee", tag:"Non Coffee", thumb:"üßã" },

      // Food
      { id:"nasgor", name:"Nasi Goreng La Madre", price:35000, cat:"food", tag:"Food", thumb:"üçõ" },
      { id:"katsu", name:"Chicken Katsu Rice Bowl", price:32000, cat:"food", tag:"Food", thumb:"üçó" },
      { id:"aglio", name:"Spaghetti Aglio Olio", price:34000, cat:"food", tag:"Food", thumb:"üçù" },
      { id:"fries", name:"French Fries", price:22000, cat:"food", tag:"Snack", thumb:"üçü" },
      { id:"mixplatter", name:"Mix Platter", price:45000, cat:"food", tag:"Snack", thumb:"ü•®" }
    ];

    // =========================
    // STATE
    // =========================
    let filter = "all";
    let query = "";
    let cart = loadCart(); // {id: qty}

    const elMenuList = document.getElementById("menuList");
    const elCartList = document.getElementById("cartList");
    const elSearch   = document.getElementById("searchInput");
    const elItems    = document.getElementById("itemsText");
    const elTotalSide= document.getElementById("totalTextSide");
    const elTotal    = document.getElementById("totalText");
    const elName     = document.getElementById("nameInput");
    const elNote     = document.getElementById("noteInput");

    const toast = document.getElementById("toast");
    let toastTimer;

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>toast.classList.remove("show"), 1200);
    }

    function formatRupiah(n){
      const s = Math.round(n).toString();
      let out = "";
      for(let i=0;i<s.length;i++){
        const idx = s.length - 1 - i;
        out = s[idx] + out;
        if(i%3===2 && idx!==0) out = "." + out;
      }
      return "Rp " + out;
    }

    function loadCart(){
      try{
        const raw = localStorage.getItem(CART_KEY);
        if(!raw) return {};
        const obj = JSON.parse(raw);
        if(typeof obj !== "object" || obj === null) return {};
        return obj;
      }catch(e){
        return {};
      }
    }
    function saveCart(){
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
    }

    function getItemById(id){
      return MENU.find(m => m.id === id);
    }

    function cartTotal(){
      let total = 0;
      for(const id in cart){
        const item = getItemById(id);
        if(!item) continue;
        total += item.price * cart[id];
      }
      return total;
    }

    function cartCount(){
      let c = 0;
      for(const id in cart) c += cart[id];
      return c;
    }

    // =========================
    // RENDER MENU
    // =========================
    function renderMenu(){
      const q = query.trim().toLowerCase();
      const list = MENU.filter(m=>{
        const okFilter = (filter === "all") || (m.cat === filter);
        const okSearch = !q || m.name.toLowerCase().includes(q) || (m.tag||"").toLowerCase().includes(q);
        return okFilter && okSearch;
      });

      elMenuList.innerHTML = "";
      if(list.length === 0){
        elMenuList.innerHTML = `<p class="muted">Menu tidak ditemukan. Coba kata kunci lain.</p>`;
        return;
      }

      list.forEach(m=>{
        const row = document.createElement("div");
        row.className = "item";
        row.innerHTML = `
          <div class="thumb" aria-hidden="true">${m.thumb || "‚òï"}</div>
          <div class="info">
            <p class="name">${m.name}</p>
            <p class="meta">${m.tag || ""}</p>
            <div class="price">${formatRupiah(m.price)}</div>
          </div>
          <button class="addBtn" type="button">Tambah</button>
        `;
        row.querySelector(".addBtn").addEventListener("click", ()=>{
          cart[m.id] = (cart[m.id] || 0) + 1;
          saveCart();
          renderCart();
          renderTotals();
          showToast("Ditambahkan ‚úÖ");
        });
        elMenuList.appendChild(row);
      });
    }

    // =========================
    // RENDER CART
    // =========================
    function renderCart(){
      const ids = Object.keys(cart).filter(id => cart[id] > 0 && getItemById(id));
      elCartList.innerHTML = "";

      if(ids.length === 0){
        elCartList.innerHTML = `<p class="muted">Belum ada pesanan. Tambahkan menu di sebelah kiri.</p>`;
        return;
      }

      ids.forEach(id=>{
        const item = getItemById(id);
        const qty = cart[id];

        const row = document.createElement("div");
        row.className = "cartRow";
        row.innerHTML = `
          <div class="thumb" aria-hidden="true">${item.thumb || "‚òï"}</div>
          <div class="info">
            <p class="name">${item.name}</p>
            <p class="meta">${formatRupiah(item.price)} / item</p>
          </div>
          <div class="qty">
            <button class="qBtn" type="button" aria-label="Kurangi">‚àí</button>
            <div class="qNum">${qty}</div>
            <button class="qBtn" type="button" aria-label="Tambah">+</button>
          </div>
          <div class="rowSum">${formatRupiah(item.price * qty)}</div>
        `;

        const [minusBtn, plusBtn] = row.querySelectorAll(".qBtn");
        minusBtn.addEventListener("click", ()=>{
          cart[id] = Math.max(0, (cart[id]||0) - 1);
          if(cart[id] === 0) delete cart[id];
          saveCart();
          renderCart();
          renderTotals();
        });
        plusBtn.addEventListener("click", ()=>{
          cart[id] = (cart[id]||0) + 1;
          saveCart();
          renderCart();
          renderTotals();
        });

        elCartList.appendChild(row);
      });
    }

    function renderTotals(){
      const count = cartCount();
      const total = cartTotal();
      elItems.textContent = count.toString();
      elTotalSide.textContent = formatRupiah(total);
      elTotal.textContent = formatRupiah(total);
    }

    // =========================
    // FILTER & SEARCH
    // =========================
    document.querySelectorAll(".pill").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        document.querySelectorAll(".pill").forEach(b=>b.classList.remove("active"));
        btn.classList.add("active");
        filter = btn.getAttribute("data-filter") || "all";
        renderMenu();
      });
    });
    elSearch.addEventListener("input", ()=>{
      query = elSearch.value || "";
      renderMenu();
    });

    // =========================
    // RESET
    // =========================
    function resetAll(){
      cart = {};
      saveCart();
      renderCart();
      renderTotals();
      showToast("Reset ‚úÖ");
    }
    document.getElementById("resetBtn").addEventListener("click", resetAll);
    document.getElementById("resetBtnTop").addEventListener("click", resetAll);

    // =========================
    // SEND WA
    // =========================
    function buildOrderMessage(){
      const name = (elName.value || "").trim();
      const note = (elNote.value || "").trim();

      const ids = Object.keys(cart).filter(id => cart[id] > 0 && getItemById(id));
      const total = cartTotal();

      const lines = [];
      lines.push("Halo La Madre Coffee & Roastery, saya mau order:");
      lines.push("");
      lines.push(`Nama: ${name}`);
      if(note) lines.push(`Catatan: ${note}`);
      lines.push("");
      lines.push("Detail Pesanan:");

      ids.forEach((id, idx)=>{
        const item = getItemById(id);
        const qty = cart[id];
        const sum = item.price * qty;
        lines.push(`${idx+1}. ${item.name} x${qty} = ${formatRupiah(sum)}`);
      });

      lines.push("");
      lines.push(`Total: ${formatRupiah(total)}`);
      lines.push("");
      lines.push("Terima kasih üôè");

      return lines.join("\n");
    }

    function sendWA(){
      const name = (elName.value || "").trim();
      const ids = Object.keys(cart).filter(id => cart[id] > 0 && getItemById(id));
      const total = cartTotal();

      if(!name){
        showToast("Isi nama dulu ‚úçÔ∏è");
        elName.focus();
        return;
      }
      if(ids.length === 0){
        showToast("Pilih menu dulu üçΩÔ∏è");
        return;
      }
      if(total <= 0){
        showToast("Total masih 0");
        return;
      }

      const msg = buildOrderMessage();
      const url = `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`;
      window.open(url, "_blank", "noreferrer");
    }

    document.getElementById("sendBtn").addEventListener("click", sendWA);

    // =========================
    // INIT
    // =========================
    renderMenu();
    renderCart();
    renderTotals();
  </script>
</body>
</html>
