<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Order/Menu ‚Äî La Madre Coffee & Roastery</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0c10;
      --bg2:#0f121a;
      --text:#eef2f7;
      --muted:#aab3c2;
      --line:rgba(255,255,255,.10);
      --card:rgba(255,255,255,.06);
      --glass:rgba(0,0,0,.25);
      --accent:#d7b56f;
      --accent2:#7bd7c9;
      --shadow: 0 26px 90px rgba(0,0,0,.50);
      --r:22px;

      --pillBg: rgba(255,255,255,.05);
      --pillOnBg: rgba(215,181,111,.18);
      --pillOnBd: rgba(215,181,111,.55);
    }
    [data-theme="light"]{
      --bg:#f6f7fb;
      --bg2:#ffffff;
      --text:#151a24;
      --muted:#5d6778;
      --line:rgba(0,0,0,.10);
      --card:rgba(0,0,0,.04);
      --glass:rgba(255,255,255,.70);
      --shadow: 0 18px 70px rgba(16,20,30,.12);

      --pillBg: rgba(0,0,0,.04);
      --pillOnBg: rgba(215,181,111,.20);
      --pillOnBd: rgba(215,181,111,.55);
    }

    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;
      font-family:"Plus Jakarta Sans",system-ui,Segoe UI,Arial,sans-serif;
      background:linear-gradient(180deg,var(--bg),var(--bg2));
      color:var(--text);
      overflow-x:hidden;
    }
    a{color:inherit;text-decoration:none}

    .wrap{width:100%;max-width:1120px;margin:0 auto;padding:0 18px;}
    @media (min-width: 1200px){ .wrap{ max-width: 1280px; padding: 0 24px; } }
    @media (min-width: 1500px){ .wrap{ max-width: 1400px; } }

    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.12'/%3E%3C/svg%3E");
      opacity:.06;
      z-index:-1;
    }
    [data-theme="light"] body::before{opacity:.035;}

    /* ===== NAV ===== */
    .nav{
      position:sticky;top:0;z-index:50;
      border-bottom:1px solid var(--line);
      backdrop-filter: blur(12px);
      background:linear-gradient(to bottom, rgba(10,12,18,.82), rgba(10,12,18,.30));
    }
    [data-theme="light"] .nav{
      background:linear-gradient(to bottom, rgba(255,255,255,.90), rgba(255,255,255,.56));
    }
    .navin{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 0}
    .brand{display:flex;gap:12px;align-items:center;min-width:0}
    .logoImg{
      width:42px;height:42px;border-radius:16px;
      object-fit:cover;border:1px solid var(--line);
      box-shadow:0 18px 45px rgba(215,181,111,.18);
      background:#000;flex:0 0 42px;
    }
    .brandTxt{min-width:0}
    .brand h1{
      margin:0;font-size:14px;line-height:1.15;letter-spacing:-.02em;
      font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
      text-transform:uppercase;
    }
    .brand p{
      margin:2px 0 0 0;color:var(--muted);font-size:12px;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis
    }

    .right{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .btn{
      padding:10px 14px;border-radius:14px;
      border:1px solid var(--line);
      background:var(--card);
      color:var(--text);
      font-weight:800;font-size:13px;
      cursor:pointer;
      transition:.18s ease;
      user-select:none;
      display:inline-flex;align-items:center;gap:8px;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px)}
    .btn.primary{
      border-color:rgba(215,181,111,.55);
      background:linear-gradient(135deg, rgba(215,181,111,.98), rgba(123,215,201,.55));
      color:#0b0c10;
      box-shadow:0 16px 40px rgba(215,181,111,.18);
    }
    .btn:active{transform:translateY(0) scale(.98)}
    .desktopOnly{display:flex}

    .hamb{
      display:none;width:44px;height:44px;border-radius:16px;
      border:1px solid var(--line);background:var(--card);color:var(--text);
      cursor:pointer;font-weight:900;font-size:18px;transition:.18s ease;
    }
    .hamb:hover{transform:translateY(-1px)}
    .hamb:active{transform:translateY(0) scale(.98)}

    .mobileMenu{
      display:none;border-top:1px solid var(--line);
      background:linear-gradient(to bottom, rgba(10,12,18,.82), rgba(10,12,18,.50));
      backdrop-filter: blur(12px);
    }
    [data-theme="light"] .mobileMenu{
      background:linear-gradient(to bottom, rgba(255,255,255,.90), rgba(255,255,255,.70));
    }
    .mobileMenu .full{
      width:100%;
      border-radius:0;border-left:0;border-right:0;border-top:0;
      padding:14px 18px;
      justify-content:flex-start;
    }
    @media (max-width: 820px){
      .desktopOnly{display:none;}
      .hamb{display:inline-flex;align-items:center;justify-content:center;}
      .mobileMenu.open{display:block;}
      .brand p{display:none;}
    }

    /* ===== PAGE ===== */
    .page{padding:18px 0 22px}
    .headRow{
      display:flex;gap:10px;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;
      margin:10px 0 14px;
    }
    .headRow h2{margin:0;font-size:20px;letter-spacing:-.02em}
    .headRow p{margin:6px 0 0 0;color:var(--muted);font-size:13px;line-height:1.5}

    .panel{
      border:1px solid var(--line);
      background:var(--card);
      border-radius:var(--r);
      padding:16px;
      box-shadow:var(--shadow);
    }
    [data-theme="light"] .panel{box-shadow: 0 18px 70px rgba(16,20,30,.10);}

    .grid{
      display:grid;
      grid-template-columns: 1.35fr .85fr;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr;}
    }

    /* ===== FILTER ===== */
    .filterBar{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0 12px;}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:10px 12px;border-radius:999px;
      border:1px solid var(--line);
      background:var(--pillBg);
      cursor:pointer;
      font-weight:900;font-size:12.6px;color:var(--text);
      transition:.18s ease;user-select:none;
    }
    .pill:hover{transform:translateY(-1px)}
    .pill.active{
      border-color: var(--pillOnBd);
      background: var(--pillOnBg);
      box-shadow: 0 10px 30px rgba(215,181,111,.14);
    }

    /* ===== MENU LIST ===== */
    .menuList{display:flex;flex-direction:column;gap:10px;}
    .item{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:18px;
      padding:12px;
      display:grid;
      grid-template-columns: 1fr auto;
      gap:12px;
      min-width:0;
    }
    [data-theme="light"] .item{background:rgba(0,0,0,.03)}
    .itemTop{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;}
    .itemName{font-weight:900;letter-spacing:-.01em;margin:0;font-size:14.5px;}
    .itemDesc{margin:4px 0 0 0;color:var(--muted);font-size:12.6px;line-height:1.45;}
    .priceWrap{font-weight:900;white-space:nowrap;font-size:13px;text-align:right;color:var(--text);}
    .itemRight{display:flex;align-items:center;justify-content:flex-end;gap:10px;}

    .qtyWrap{
      display:flex;align-items:center;gap:8px;
      padding:8px;border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
    }
    [data-theme="light"] .qtyWrap{background:rgba(0,0,0,.03)}
    .qbtn{
      width:34px;height:34px;border-radius:12px;
      border:1px solid var(--line);
      background:var(--card);color:var(--text);
      cursor:pointer;font-weight:900;
      display:inline-flex;align-items:center;justify-content:center;
      transition:.15s ease;user-select:none;
    }
    .qbtn:active{transform:scale(.97)}
    .qval{min-width:24px;text-align:center;font-weight:900;font-size:13px;}

    /* ===== CART ===== */
    .cartTop{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:10px;}
    .cartTop h3{margin:0;font-size:15px}
    .cartTop small{color:var(--muted)}
    .cartBox{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:18px;
      padding:12px;
    }
    [data-theme="light"] .cartBox{background:rgba(0,0,0,.03)}
    .cartEmpty{color:var(--muted);font-size:13px;line-height:1.6;margin:0}
    .cartList{margin:0;padding:0;list-style:none;display:flex;flex-direction:column;gap:8px}
    .cartList li{
      display:flex;align-items:flex-start;justify-content:space-between;gap:10px;
      font-size:13px;border-bottom:1px dashed var(--line);padding-bottom:8px;
    }
    .cartList li:last-child{border-bottom:0;padding-bottom:0}
    .cartList b{font-weight:900}
    .cartList span{color:var(--muted)}
    .sumRow{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin-top:10px;padding:12px;border-radius:16px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.10);
    }
    [data-theme="light"] .sumRow{background:rgba(0,0,0,.03)}
    .sumRow b{font-size:14px}
    .sumRow .money{font-size:15px;font-weight:900}

    .form{display:flex;flex-direction:column;gap:10px;margin-top:10px;}
    .inp,.txt{
      width:100%;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--text);
      border-radius:16px;
      padding:12px;
      outline:none;
      font-weight:700;
      font-size:13.2px;
    }
    [data-theme="light"] .inp,[data-theme="light"] .txt{background:rgba(0,0,0,.03)}
    .txt{min-height:92px;resize:vertical}
    .hint{color:var(--muted);font-size:12.2px;line-height:1.5;margin-top:2px;}

    /* ===== PAYMENT BUTTONS (click) ===== */
    .payRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px;}
    .payBtn{
      display:inline-flex;align-items:center;gap:8px;
      padding:10px 12px;border-radius:16px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      cursor:pointer;font-weight:900;font-size:12.8px;
      user-select:none;transition:.15s ease;
    }
    [data-theme="light"] .payBtn{background:rgba(0,0,0,.03)}
    .payBtn:hover{transform:translateY(-1px)}
    .payBtn.active{
      border-color: var(--pillOnBd);
      background: var(--pillOnBg);
      box-shadow: 0 10px 30px rgba(215,181,111,.12);
    }

    /* ===== ACTIONS ===== */
    .actions{
      display:flex;gap:10px;align-items:center;justify-content:flex-end;flex-wrap:wrap;
      margin-top:12px;
    }

    /* ===== MOBILE BOTTOM BAR ===== */
    @media (max-width: 980px){
      body{ padding-bottom: 94px; }
      .actions{display:none;}
    }
    .bottomBar{display:none;}
    @media (max-width: 980px){
      .bottomBar{
        display:flex;
        position:fixed;left:0; right:0; bottom:0;
        z-index:999;
        padding:12px 14px;
        border-top:1px solid var(--line);
        background:linear-gradient(to top, rgba(10,12,18,.92), rgba(10,12,18,.65));
        backdrop-filter: blur(12px);
      }
      [data-theme="light"] .bottomBar{
        background:linear-gradient(to top, rgba(255,255,255,.92), rgba(255,255,255,.70));
      }
      .bbWrap{
        width:100%;
        max-width:1120px;
        margin:0 auto;
        display:flex;align-items:center;justify-content:space-between;gap:12px;
      }
      .bbLeft{min-width:0;display:flex;flex-direction:column;gap:4px;}
      .bbLeft b{font-size:14px;}
      .bbLeft small{color:var(--muted);font-size:12px;}
      .bbRight{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end;}
    }

    /* ===== QRIS MODAL ===== */
    .modal{
      position:fixed;inset:0;
      display:none;align-items:center;justify-content:center;
      z-index:2000;padding:18px;
      background:rgba(0,0,0,.55);
      backdrop-filter: blur(8px);
    }
    .modal.open{display:flex;}
    .modalCard{
      width:min(560px, 100%);
      border-radius:22px;
      border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(15,18,26,.92), rgba(10,12,18,.85));
      box-shadow: 0 40px 140px rgba(0,0,0,.65);
      overflow:hidden;
    }
    [data-theme="light"] .modalCard{
      background:linear-gradient(180deg, rgba(255,255,255,.95), rgba(255,255,255,.85));
      box-shadow: 0 30px 110px rgba(16,20,30,.18);
    }
    .modalHead{
      padding:14px 16px;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      border-bottom:1px solid var(--line);
    }
    .modalHead b{font-weight:900}
    .modalBody{padding:16px}
    .qrisTotal{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin-bottom:12px;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
    }
    [data-theme="light"] .qrisTotal{background:rgba(0,0,0,.03)}
    .qrisTotal small{color:var(--muted);font-weight:800}
    .qrisTotal b{font-size:16px;font-weight:900}
    .qrisImg{
      width:100%;
      border-radius:18px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      display:block;
      object-fit:contain;
      aspect-ratio: 1 / 1;
      max-height: 440px;
    }
    .modalNote{margin:12px 0 0 0;color:var(--muted);font-size:12.6px;line-height:1.6;}
    .modalBtns{
      padding:14px 16px;display:flex;gap:10px;justify-content:flex-end;
      border-top:1px solid var(--line);flex-wrap:wrap;
    }

    /* mobile item layout safe */
    @media (max-width: 980px){
      .item{ grid-template-columns:1fr !important; }
      .itemRight{ width:100%; justify-content:space-between; }
      .priceWrap{ text-align:left; }
    }
  </style>
</head>

<body>
  <!-- NAV -->
  <div class="nav">
    <div class="wrap navin">
      <div class="brand">
        <img class="logoImg" src="logo-lamadre.png" alt="La Madre Logo">
        <div class="brandTxt">
          <h1>LA MADRE COFFEE &amp; ROASTERY</h1>
          <p>Order/Menu</p>
        </div>
      </div>

      <div class="right desktopOnly">
        <button class="btn" id="themeBtn" type="button">üåì Mode</button>
        <a class="btn" href="index.html">üè† Home</a>
        <button class="btn" id="printBtnTop" type="button">üñ®Ô∏è Cetak Struk (PDF)</button>
        <button class="btn primary" id="goSummary" type="button">üßæ Ringkasan</button>
      </div>

      <button class="hamb" id="hambBtn" type="button" aria-label="Buka menu" aria-expanded="false">‚ò∞</button>
    </div>

    <div class="mobileMenu" id="mobileMenu">
      <button class="btn full" id="themeBtnM" type="button">üåì Mode Gelap/Terang</button>
      <a class="btn full" href="index.html">üè† Home</a>
      <button class="btn full" id="printBtnTopM" type="button">üñ®Ô∏è Cetak Struk (PDF)</button>
      <button class="btn primary full" id="goSummaryM" type="button">üßæ Ringkasan</button>
    </div>
  </div>

  <main class="page">
    <div class="wrap">
      <div class="headRow">
        <div>
          <h2>Order/Menu</h2>
          <p>Pilih menu, tentukan jumlah, lalu klik <b>Buat Pesanan</b>. Detail item + jumlah + total akan terkirim ke WhatsApp.</p>
        </div>
      </div>

      <div class="grid">
        <!-- LEFT -->
        <section class="panel">
          <div class="cartTop">
            <div>
              <h3 style="margin:0">Menu Pilihan</h3>
              <small>Klik + / ‚àí untuk menambah/mengurangi pesanan.</small>
            </div>
          </div>

          <div class="filterBar" id="filterBar"></div>
          <div class="menuList" id="menuList"></div>

          <div class="hint" style="margin-top:10px">
            * Menu bisa kamu edit di bagian <b>const MENU</b> pada script (nama, kategori, deskripsi, harga).
          </div>
        </section>

        <!-- RIGHT -->
        <aside class="panel" id="cartPanel">
          <div class="cartTop">
            <div>
              <h3 style="margin:0">Pesanan Kamu</h3>
              <small>Ringkasan item yang sudah kamu pilih.</small>
            </div>
          </div>

          <div class="cartBox">
            <p class="cartEmpty" id="cartEmpty">Belum ada pesanan. Silakan pilih menu di sebelah kiri.</p>
            <ul class="cartList" id="cartList" style="display:none"></ul>

            <div class="sumRow">
              <b>Total</b>
              <div class="money" id="totalText">Rp 0</div>
            </div>

            <!-- keterangan bawah jumlah/total (tetap ada) -->
            <div class="hint" style="margin-top:10px" id="countText">0 item dipilih</div>

            <div class="form">
              <input class="inp" id="buyerName" type="text" placeholder="Nama pemesan (wajib)" />
              <textarea class="txt" id="notes" placeholder="Catatan (opsional)"></textarea>

              <div>
                <div style="font-weight:900;font-size:13px;margin-bottom:6px">Metode Pembayaran</div>
                <div class="payRow" id="payRow">
                  <button class="payBtn active" type="button" data-pay="CASH">üíµ Cash</button>
                  <button class="payBtn" type="button" data-pay="TRANSFER">üè¶ Transfer</button>
                  <button class="payBtn" type="button" data-pay="QRIS">üì± QRIS</button>
                </div>
                <div class="hint" style="margin-top:8px">
                  Jika pilih <b>QRIS</b>, QR akan muncul (pop-up) lengkap dengan total yang harus dibayar.
                </div>
              </div>

              <div class="actions">
                <button class="btn" id="resetBtn" type="button">üîÑ Reset</button>
                <button class="btn" id="printBtn" type="button">üñ®Ô∏è Cetak Struk (PDF)</button>
                <a class="btn" href="index.html">‚Üê Kembali</a>
                <button class="btn primary" id="orderBtn" type="button">‚úÖ Buat Pesanan</button>
              </div>

              <div class="hint">
                Setelah klik ‚ÄúBuat Pesanan‚Äù, WhatsApp akan terbuka dengan detail item + jumlah + total + metode bayar.
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </main>

  <!-- MOBILE BOTTOM BAR -->
  <div class="bottomBar" id="bottomBar">
    <div class="bbWrap">
      <div class="bbLeft">
        <b>Total: <span id="bbTotal">Rp 0</span></b>
        <small><span id="bbCount">0</span> item dipilih</small>
      </div>

      <div class="bbRight">
        <button class="btn" type="button" id="bbReset">üîÑ Reset</button>
        <button class="btn" type="button" id="bbPrint">üñ®Ô∏è Struk</button>
        <a class="btn" href="index.html">‚Üê Kembali</a>
        <button class="btn primary" type="button" id="bbOrder">‚úÖ Buat Pesanan</button>
      </div>
    </div>
  </div>

  <!-- QRIS MODAL -->
  <div class="modal" id="qrisModal" role="dialog" aria-modal="true" aria-label="QRIS La Madre">
    <div class="modalCard">
      <div class="modalHead">
        <b>QRIS ‚Äî La Madre Coffee & Roastery</b>
        <button class="btn" type="button" id="qrisClose">‚úï Tutup</button>
      </div>
      <div class="modalBody">
        <!-- total bayar tampil -->
        <div class="qrisTotal">
          <small>Total yang harus dibayar</small>
          <b id="qrisTotalText">Rp 0</b>
        </div>

        <!-- GANTI FILE QRIS DI REPO: qris.png -->
        <img class="qrisImg" id="qrisImg" src="qris.png" alt="QRIS La Madre">

        <p class="modalNote">
          Scan QRIS di atas, selesaikan pembayaran di aplikasi kamu, lalu klik ‚ÄúBuat Pesanan‚Äù agar detail order + total terkirim ke WhatsApp.
        </p>
      </div>
      <div class="modalBtns">
        <button class="btn" type="button" id="qrisPrint">üñ®Ô∏è Cetak Struk</button>
        <button class="btn primary" type="button" id="qrisOk">‚úÖ Sudah bayar</button>
      </div>
    </div>
  </div>

  <script>
    /* =========================
       THEME
    ========================== */
    (function(){
      const key = "theme_lamadre";
      const btnD = document.getElementById("themeBtn");
      const btnM = document.getElementById("themeBtnM");

      function applySaved(){
        const saved = localStorage.getItem(key);
        if(saved === "light") document.documentElement.setAttribute("data-theme","light");
        else document.documentElement.removeAttribute("data-theme");
      }
      function toggle(){
        const isLight = document.documentElement.getAttribute("data-theme")==="light";
        if(isLight){
          document.documentElement.removeAttribute("data-theme");
          localStorage.setItem(key,"dark");
        }else{
          document.documentElement.setAttribute("data-theme","light");
          localStorage.setItem(key,"light");
        }
      }
      applySaved();
      if(btnD) btnD.addEventListener("click", toggle);
      if(btnM) btnM.addEventListener("click", toggle);
    })();

    /* =========================
       MOBILE MENU
    ========================== */
    (function(){
      const hambBtn = document.getElementById("hambBtn");
      const mobileMenu = document.getElementById("mobileMenu");
      if(!hambBtn || !mobileMenu) return;

      hambBtn.addEventListener("click", ()=>{
        const open = mobileMenu.classList.toggle("open");
        hambBtn.setAttribute("aria-expanded", open ? "true" : "false");
        hambBtn.textContent = open ? "‚úï" : "‚ò∞";
      });

      mobileMenu.addEventListener("click", (e)=>{
        if(e.target.tagName === "A" || e.target.id === "goSummaryM"){
          mobileMenu.classList.remove("open");
          hambBtn.setAttribute("aria-expanded","false");
          hambBtn.textContent = "‚ò∞";
        }
      });
    })();

    /* =========================
       MENU (EDIT HERE)
    ========================== */
    const MENU = [
      {id:"espresso",      name:"Espresso",             desc:"Single shot, bold & clean.",        price:20000, cat:"Coffee"},
      {id:"americano",     name:"Americano",            desc:"Long black, light & smooth.",       price:25000, cat:"Coffee"},
      {id:"cafelatte",     name:"Cafe Latte",           desc:"Creamy milk & espresso.",          price:32000, cat:"Coffee"},
      {id:"butterscotch",  name:"Butterscotch Latte",   desc:"Sweet, creamy, crowd favorite.",   price:36000, cat:"Coffee"},
      {id:"matcha",        name:"Matcha Latte",         desc:"Earthy, creamy matcha.",           price:32000, cat:"Non Coffee"},
      {id:"fries",         name:"French Fries",         desc:"Crispy fries, perfect snack.",     price:25000, cat:"Snack"},
      {id:"toast",         name:"Bread Toast",          desc:"Toasted bread with topping.",      price:28000, cat:"Snack"},
      {id:"grilled",       name:"Grilled Chicken Rice", desc:"Comfort food for lunch/dinner.",   price:45000, cat:"Food"},
    ];

    /* =========================
       HELPERS
    ========================== */
    const WA_NUMBER = "6281398686801";
    const moneyFmt = new Intl.NumberFormat("id-ID");
    function toIDR(n){ return "Rp " + moneyFmt.format(n); }
    function nowText(){
      const d = new Date();
      const pad = (x)=> String(x).padStart(2,"0");
      return `${pad(d.getDate())}/${pad(d.getMonth()+1)}/${d.getFullYear()} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
    }

    /* =========================
       STATE
    ========================== */
    let activeCat = "ALL";
    let payment = "CASH";
    const cart = {}; // id -> qty

    function getCount(){
      let c = 0;
      for(const k in cart) c += cart[k];
      return c;
    }
    function getTotal(){
      let t = 0;
      for(const it of MENU){
        const q = cart[it.id] || 0;
        t += q * it.price;
      }
      return t;
    }

    /* =========================
       RENDER FILTER
    ========================== */
    const filterBar = document.getElementById("filterBar");
    function renderFilters(){
      const cats = ["ALL", ...Array.from(new Set(MENU.map(x=>x.cat)))];
      filterBar.innerHTML = "";
      cats.forEach(c=>{
        const b = document.createElement("button");
        b.type = "button";
        b.className = "pill" + (c===activeCat ? " active" : "");
        b.textContent = (c==="ALL") ? "Semua kategori" : c;
        b.addEventListener("click", ()=>{
          activeCat = c;
          renderFilters();
          renderMenu();
        });
        filterBar.appendChild(b);
      });
    }

    /* =========================
       RENDER MENU
    ========================== */
    const menuList = document.getElementById("menuList");

    function renderMenu(){
      menuList.innerHTML = "";
      const data = (activeCat==="ALL") ? MENU : MENU.filter(x=>x.cat===activeCat);

      data.forEach(it=>{
        const qty = cart[it.id] || 0;

        const el = document.createElement("div");
        el.className = "item";
        el.innerHTML = `
          <div>
            <div class="itemTop">
              <div style="min-width:0">
                <p class="itemName">${it.name}</p>
                <p class="itemDesc">${it.desc}</p>
              </div>
              <div class="priceWrap">${toIDR(it.price)}</div>
            </div>
          </div>

          <div class="itemRight">
            <div class="qtyWrap">
              <button class="qbtn" type="button" data-act="minus">‚àí</button>
              <div class="qval" id="q_${it.id}">${qty}</div>
              <button class="qbtn" type="button" data-act="plus">+</button>
            </div>
          </div>
        `;

        el.querySelector('[data-act="minus"]').addEventListener("click", ()=>{
          cart[it.id] = Math.max(0, (cart[it.id]||0) - 1);
          if(cart[it.id]===0) delete cart[it.id];
          document.getElementById("q_"+it.id).textContent = String(cart[it.id]||0);
          renderCart();
        });

        el.querySelector('[data-act="plus"]').addEventListener("click", ()=>{
          cart[it.id] = (cart[it.id]||0) + 1;
          document.getElementById("q_"+it.id).textContent = String(cart[it.id]||0);
          renderCart();
        });

        menuList.appendChild(el);
      });
    }

    /* =========================
       CART RENDER
    ========================== */
    const cartEmpty = document.getElementById("cartEmpty");
    const cartList  = document.getElementById("cartList");
    const totalText = document.getElementById("totalText");
    const countText = document.getElementById("countText");

    const qrisTotalText = document.getElementById("qrisTotalText");

    function renderCart(){
      const count = getCount();
      const total = getTotal();

      totalText.textContent = toIDR(total);
      countText.textContent = `${count} item dipilih`;

      // bottom bar sync
      document.getElementById("bbTotal").textContent = toIDR(total);
      document.getElementById("bbCount").textContent = String(count);

      // qris total sync (kalau modal dibuka)
      qrisTotalText.textContent = toIDR(total);

      if(count === 0){
        cartEmpty.style.display = "block";
        cartList.style.display = "none";
        cartList.innerHTML = "";
        return;
      }

      cartEmpty.style.display = "none";
      cartList.style.display = "flex";
      cartList.innerHTML = "";

      for(const it of MENU){
        const q = cart[it.id] || 0;
        if(!q) continue;

        const li = document.createElement("li");
        const sub = q * it.price;
        li.innerHTML = `
          <div>
            <b>${it.name}</b><br>
            <span>${q}x ‚Ä¢ ${toIDR(it.price)}</span>
          </div>
          <div style="font-weight:900">${toIDR(sub)}</div>
        `;
        cartList.appendChild(li);
      }
    }

    /* =========================
       PAYMENT CLICK BUTTONS
    ========================== */
    const payRow = document.getElementById("payRow");
    payRow.addEventListener("click", (e)=>{
      const btn = e.target.closest(".payBtn");
      if(!btn) return;

      payment = btn.getAttribute("data-pay") || "CASH";
      payRow.querySelectorAll(".payBtn").forEach(b=>b.classList.toggle("active", b===btn));

      if(payment === "QRIS"){
        openQris();
      }
    });

    /* =========================
       QRIS MODAL
    ========================== */
    const qrisModal = document.getElementById("qrisModal");
    const qrisClose = document.getElementById("qrisClose");
    const qrisOk    = document.getElementById("qrisOk");
    const qrisPrint = document.getElementById("qrisPrint");

    function openQris(){
      qrisTotalText.textContent = toIDR(getTotal());
      qrisModal.classList.add("open");
      document.body.style.overflow = "hidden";
    }
    function closeQris(){
      qrisModal.classList.remove("open");
      document.body.style.overflow = "";
    }

    qrisClose.addEventListener("click", closeQris);
    qrisOk.addEventListener("click", closeQris);
    qrisModal.addEventListener("click", (e)=>{
      if(e.target === qrisModal) closeQris();
    });

    /* =========================
       WHATSAPP ORDER
    ========================== */
    const buyerName = document.getElementById("buyerName");
    const notes     = document.getElementById("notes");

    function buildWhatsAppText(){
      const name = (buyerName.value || "").trim();
      const note = (notes.value || "").trim();
      const total = getTotal();
      const count = getCount();

      let lines = [];
      lines.push("Halo La Madre Coffee & Roastery, saya ingin order:");
      lines.push("");

      for(const it of MENU){
        const q = cart[it.id] || 0;
        if(!q) continue;
        lines.push(`‚Ä¢ ${it.name} ‚Äî ${q}x (${toIDR(it.price)}) = ${toIDR(q*it.price)}`);
      }

      lines.push("");
      lines.push(`Total item: ${count}`);
      lines.push(`Total bayar: ${toIDR(total)}`);
      lines.push(`Metode bayar: ${payment}`);
      if(name) lines.push(`Nama: ${name}`);
      if(note) lines.push(`Catatan: ${note}`);

      if(payment === "QRIS"){
        lines.push("");
        lines.push("Saya bayar via QRIS (sudah scan QR di website).");
      }

      return lines.join("\n");
    }

    function sendOrder(){
      const name = (buyerName.value || "").trim();
      const count = getCount();

      if(count === 0){
        alert("Pesanan masih kosong. Silakan pilih minimal 1 menu.");
        return;
      }
      if(!name){
        alert("Nama pemesan wajib diisi ya.");
        buyerName.focus();
        return;
      }

      const text = buildWhatsAppText();
      const url = `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(text)}`;
      window.open(url, "_blank");
    }

    /* =========================
       PRINT STRUK (PDF)
       - via window.print() -> user can "Save as PDF"
    ========================== */
    function buildReceiptHTML(){
      const name = (buyerName.value || "").trim() || "-";
      const note = (notes.value || "").trim() || "-";
      const total = getTotal();
      const count = getCount();

      const rows = MENU
        .filter(it => (cart[it.id]||0) > 0)
        .map(it=>{
          const q = cart[it.id];
          const sub = q * it.price;
          return `
            <tr>
              <td style="padding:8px 6px;border-bottom:1px dashed #999;vertical-align:top">
                <div style="font-weight:800">${it.name}</div>
                <div style="opacity:.8;font-size:12px">${q} x ${toIDR(it.price)}</div>
              </td>
              <td style="padding:8px 6px;border-bottom:1px dashed #999;text-align:right;white-space:nowrap;vertical-align:top">
                ${toIDR(sub)}
              </td>
            </tr>
          `;
        }).join("");

      const theme = document.documentElement.getAttribute("data-theme")==="light" ? "light" : "dark";
      const bg = theme==="light" ? "#ffffff" : "#0b0c10";
      const fg = theme==="light" ? "#121826" : "#eef2f7";
      const muted = theme==="light" ? "rgba(18,24,38,.75)" : "rgba(238,242,247,.75)";
      const border = theme==="light" ? "rgba(0,0,0,.12)" : "rgba(255,255,255,.14)";

      return `
      <!doctype html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <title>Struk ‚Äî La Madre</title>
        <style>
          body{margin:0;background:${bg};color:${fg};font-family:system-ui,-apple-system,Segoe UI,Arial,sans-serif}
          .paper{
            max-width: 420px;
            margin: 24px auto;
            border:1px solid ${border};
            border-radius:16px;
            padding:16px;
          }
          h1{margin:0;font-size:16px;letter-spacing:.04em}
          .sub{margin-top:6px;color:${muted};font-size:12px;line-height:1.4}
          .hr{height:1px;background:${border};margin:12px 0}
          table{width:100%;border-collapse:collapse;font-size:13px}
          .sum{display:flex;justify-content:space-between;gap:10px;margin-top:10px;font-size:13px}
          .sum b{font-size:14px}
          .foot{margin-top:14px;color:${muted};font-size:12px;line-height:1.5;text-align:center}
          @media print{
            body{background:#fff;color:#000}
            .paper{border:0;margin:0;max-width:100%;border-radius:0}
          }
        </style>
      </head>
      <body>
        <div class="paper">
          <h1>LA MADRE COFFEE & ROASTERY</h1>
          <div class="sub">Order/Menu ‚Äî Bukti Pesanan</div>
          <div class="sub">Waktu: ${nowText()}</div>

          <div class="hr"></div>

          <div class="sub"><b>Nama:</b> ${escapeHTML(name)}</div>
          <div class="sub"><b>Metode bayar:</b> ${escapeHTML(payment)}</div>
          <div class="sub"><b>Catatan:</b> ${escapeHTML(note)}</div>

          <div class="hr"></div>

          <table>
            <tbody>
              ${rows || `<tr><td colspan="2" style="padding:10px 0;color:${muted}">Tidak ada item.</td></tr>`}
            </tbody>
          </table>

          <div class="hr"></div>

          <div class="sum"><span>Total item</span><b>${count}</b></div>
          <div class="sum"><span>Total bayar</span><b>${toIDR(total)}</b></div>

          <div class="foot">
            Terima kasih üôè<br>
            La Madre Coffee & Roastery
          </div>
        </div>

        <script>
          window.onload = () => window.print();
        </script>
      </body>
      </html>
      `;
    }

    function escapeHTML(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function printReceipt(){
      const count = getCount();
      if(count === 0){
        alert("Pesanan masih kosong. Pilih menu dulu untuk cetak struk.");
        return;
      }
      const w = window.open("", "_blank");
      w.document.open();
      w.document.write(buildReceiptHTML());
      w.document.close();
    }

    /* =========================
       BUTTONS
    ========================== */
    // desktop
    document.getElementById("orderBtn").addEventListener("click", sendOrder);
    document.getElementById("resetBtn").addEventListener("click", ()=>{
      for(const k in cart) delete cart[k];
      buyerName.value = "";
      notes.value = "";
      document.querySelectorAll('[id^="q_"]').forEach(el=>el.textContent="0");
      renderCart();
    });
    document.getElementById("printBtn").addEventListener("click", printReceipt);

    // top print buttons
    document.getElementById("printBtnTop").addEventListener("click", printReceipt);
    document.getElementById("printBtnTopM").addEventListener("click", printReceipt);

    // bottom bar
    document.getElementById("bbOrder").addEventListener("click", sendOrder);
    document.getElementById("bbReset").addEventListener("click", ()=>document.getElementById("resetBtn").click());
    document.getElementById("bbPrint").addEventListener("click", printReceipt);

    // qris modal print
    qrisPrint.addEventListener("click", printReceipt);

    // go summary
    function goSummary(){
      document.getElementById("cartPanel").scrollIntoView({behavior:"smooth", block:"start"});
    }
    document.getElementById("goSummary").addEventListener("click", goSummary);
    document.getElementById("goSummaryM").addEventListener("click", goSummary);

    /* =========================
       INIT
    ========================== */
    renderFilters();
    renderMenu();
    renderCart();
  </script>
</body>
</html>
